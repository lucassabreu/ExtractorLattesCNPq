{
  "name": "ExtratorLattesCNPq",
  "tagline": "Extrator em C# para tratar a leitura de currículos XML da Plataforma Lattes do CNPq e alimentá-los em uma base de dados SQL para fins de consulta.",
  "body": "# Extrator Lattes CNPq #\r\n\r\nO conhecimento sobre a produção cientifica de uma instituição de ensino superior possui um papel importante para determinar a qualidade da mesma, assim como responder a oportunidades dadas a mesma seja por editais de licitação ou projetos de pesquisa. Com essas informações é possível determinar os limites e competências da instituição. Uma forma de analisar essas características é através dos currículos de seus profissionais. \r\n\r\nNeste repositório está disponibilizado o código fonte da solução desenvolvida para trabalho de conclusão de curso de Bacharelado em Sistemas de Informação da Universidade da Região de Joinville – [Univille](http://univille.edu.br) para coleta dessas informações curriculares dos professionais, usando como base os dados existentes na [Plataforma Lattes](http://lattes.cnpq.br/) do CNPq. \r\n\r\nIr para [Execução](#execução).\r\n\r\nIr para [Instalação e Configuração](#instalação-e-configuração).\r\n\r\n## Conceito ##\r\n\r\nPara acessar os dados dos currículos, **utilizou-se o acesso disponibilizado pelo CNPq via VPN** que através de um arquivo em formato XML, permite o consulta das informações dos currículos Lattes dos professores da instituição. \r\n\r\nCom base na documentação disponibilizada pelo CNPq, mapeou-se os dados presentes no XML e modelou-se uma base  _Data Warehouse_ com os dados dos currículos, porém mais acessível para consulta. Por exemplo, todas as Produções Técnicas foram agrupadas em uma tabela que possui um identificador detalhando se esta produção é uma \"Cultivar\", \"Patente\", \"Software\", etc., o que facilita a leitura dos dados em comparação a estrutura hierárquica do XML. Este tipo de \"remodelagem\" foi aplicado a praticamente todas as tabelas de modo que a base se tornasse mais performática e legível. \r\n\r\nOutra informação importante incluída no _Data Warehouse_, foi das classificações dos periódicos do Qualis, criando a possibilidade de análise dos artigos gerados pela Instituição.\r\n\r\nCom a base modelada e acesso ao serviço do Lattes, foi desenvolvido um programa em C# para se comunicar com o serviço citado. A aplicação busca o currículo dos pesquisadores da IES e transforma os dados do XML para que possam ser gravados na Data Warehouse. \r\n\r\nA aplicação ainda avalia as informações das produções científicas e projetos dos professores para que não fiquem duplicadas na base de dados baseando-se no ano, tipo e título das mesmas. Dessa forma, caso dois pesquisadores tenham citado um mesmo projeto ou produção em seus currículos, ao invés de inserir dois registros o programa irá apenas vincular os dois pesquisadores ao um mesmo registro de produção/projeto. Para a produção bibliográfica também é associado qual o extrato Qualis o mesmo está classificado.\r\n\r\nUma vez que os dados estejam carregados no DW utilizou-se a ferramenta de _Business Intelligence_ [Tableau](http://www.tableau.com/), que permite a criação de paneis utilizando a base de dados construída anteriormente. No Tableau foram então criadas consultas e painéis para análise das informações geradas. O arquivo com os painéis gerados pode ser acessado [aqui](AnaliseCurriculosLattes.twb).\r\n\r\nA cada execução o extrator verifica se o currículo em questão sofreu alterações desde a última extração e irá carregar apenas os currículos que foram alterados, dessa forma torna a execução incremental e mais performática.\r\n\r\n## Execução ##\r\n\r\nO LattesExtractor está preparado para ser executado de duas formas. \r\n\r\nA primeira não recebe parâmetros pela linha de comando e irá executar a extração dos Currículos na Plataforma Lattes conforme os [Parâmetros da Aplicação](#parâmetros-da-aplicação).\r\n\r\nA segunda forma recebe o parâmetro `-q` e o valor deverá ser o caminho para uma planilha com as informações sobre a Classificação Qualis dos Periódicos. Quando executado dessa forma o extrator irá alimentar e atualizar a classificação dos Periódicos. \r\nEx.: `LattesExtractor.exe -q qualis.csv`\r\n\r\nUm exemplo de planilha pode ser encontrado em: [LattesExtractor/resources/Consulta_Webqualis.csv](LattesExtractor/resources/Consulta_Webqualis.csv).\r\n\r\nAs novas classificações podem ser recuperadas na [Plataforma Sucupira](https://sucupira.capes.gov.br) na área de consulta de dados para os \"Periódicos Qualis\" ([clique aqui](https://sucupira.capes.gov.br/sucupira/public/consultas/coleta/veiculoPublicacaoQualis/listaConsultaGeralPeriodicos.jsf)). É importante avisar que a planilha gerada na Plataforma Sucupira precisara ser trabalhada antes do programa conseguir importá-la. Primeiramnete deve ser alterado o formato da mesma de Excel 2007 (.xls) para CSV (*.csv).\r\n\r\nE deverá ser alterado para que cada linha tenha apenas uma área de avaliação no caso a linha abaixo:\r\n\r\nISSN      | Título                      | Área de Avaliação                           | Estrato\r\n----------|-----------------------------|---------------------------------------------|---------\r\n1980-4814 | ABCustos (São Leopoldo, RS) | ADMINISTRAÇÃO, CIÊNCIAS CONTÁBEIS E TURISMO | B4\r\n\r\nDeve ficar assim:\r\n\r\nISSN      | Título                      | Área de Avaliação            | Estrato\r\n----------|-----------------------------|------------------------------|---------\r\n1980-4814 | ABCustos (São Leopoldo, RS) | ADMINISTRAÇÃO                | B4\r\n1980-4814 | ABCustos (São Leopoldo, RS) | CIÊNCIAS CONTÁBEIS E TURISMO | B4\r\n\r\n## Instalação e Configuração ##\r\n\r\nPara execução do extrator é necessário possuir acesso a VPN do CNPq, mais informações sobre como obtê-la é necessário conversar com um representante do CNPq.\r\n\r\nTambém necessário um servidor de banco de dados para armazenar os dados gerados na extração, o mesmo deverá ser criado utilizando uma estrutura de tabelas que seja compatível com o extrator. No arquivo [dblattes_creation_script.sql](LattesExtractor/resources/dblattes_creation_script.sql) existe um script T-SQL criando uma base de dados do SQL Server compatível.\r\n\r\nExistem dois arquivos de configuração, um deles para a extração de dados ([App.config](LattesExtractor/App.config)) e outro para os logs ([LattesExtractor.log4net](LattesExtractor/LattesExtractor.log4net)). Para a configuração sugerimos verificar diretamente com no site do Framework [Apache Log4Net](https://logging.apache.org/log4net/) que foi utilizado para este fim.\r\n\r\nAbaixo seguem as configurações do **LattesExtractor**:\r\n\r\n### Parâmetros da Aplicação ###\r\n\r\nParâmetro                             | Explicação\r\n------------------------------------- | --------------- \r\nTempDir                               | Informar o diretório temporário onde serão guardados os arquivos XML dos currículos até que sejam lidos\r\nLattesCurriculumVitaeODBCConnection   | Linha de conexão ODBC para uma base de onde serão lidos quais são os pesquisadores da instituição. \r\nLattesCurriculumVitaeQuery            | Query SQL que irá retornar os dados a partir da conexão informada no parâmetro _LattesCurriculumVitaeODBCConnection_\r\n\r\n**Sobre a Conexão ODBC:** \r\nDeve ser informada uma conexão ODBC válida, essa conexão pode ser feita com uma planilha Excel, por exemplo, usando o Jet.OLEDB, o valor do parâmetro ficaria: `\"Provider=Microsoft.Jet.OLEDB.4.0; Data Source=.\\resources\\IDs_Curriculos.local.xls; Extended Properties='Excel 8.0;HDR=YES;'\"`\r\n\r\n**Sobre a Query**\r\n\r\nA lógica do extrator está preparado para tratar 3 formatos de queries e define como lidar com elas de acordo com o número de colunas da query, recomenda-se utilizar a opção 2 para melhor performance.\r\n\r\n* 1 Coluna: Entende que esta sendo informado apenas o Número do Currículo Lattes do pesquisador. Ex.: `SELECT [numerolattes] FROM [lattes$]`\r\n* 2 Colunas: Entende que esta sendo informado o Número do Currículo Lattes e Nome do pesquisador, essa opção auxiliar na leitura do Log de execução. Ex.: `SELECT [numerolattes], [nomeprofessor] FROM [lattes$]`\r\n* 3 Colunas: O programa entende que são informados o Nome, Data de Nascimento e CPF do pesquisador, usando essa opção o LattesExtrator irá buscar sozinho o Número Lattes do pesquisador e retornar o currículo do mesmo. É uma opção útil caso não sejam conhecidos os números dos currículos do pesquisadores, mas irá tornar a execução um pouco mais lenta. Ex.: `SELECT [nomeprofessor], [datanascimento], [cpf] FROM [ids_lattes$]` \r\n* 4 Colunas: o programa entende que será informado o Número do Currículo Lattes, Nome, Data de Nascimento e CPF do pesquisador, sendo o número do currículo opcional, essa opção é útil caso tenha apenas partes do números dos currículos, dessa forma realizando uma consulta \"mista\". Ex.: `SELECT [numerolattes], [nomeprofessor], [datanascimento], [cpf] FROM [ids_lattes$]` \r\n\r\n### Parametrizando WebService CNPq ###\r\n\r\nO CNPq disponibilizou um WebService SOAP que permite consultar os currículos dos pesquisadores e descobrir os Número Lattes dos mesmos. O endereço do mesmo pode mudar no futuro, caso isso aconteça, deve ser alterado essa informação para o WebService \"WSCurriculo\"\r\n\r\n### Conexão da Base _Data Warehouse_ ###\r\n\r\nA aplicação esta utilizando o [Entity Framework](https://msdn.microsoft.com/library/bb399567.aspx) para conexão e manipulação do banco de dados. Para alterar o banco de destino dos dados basta alterar a _Connection String_ de nome _LattesDatabase_ no arquivo App.config.\r\n\r\nHoje o extrator está preparado para usar o SQL Server como banco de dados de destino. Trocar para outro serviço precisará que sejam adicionadas outras bibliotecas fornecidas pelo seu serviço de banco de dados. \r\n\r\n## Licença e Distribuição ##\r\n\r\nVeja o arquivo [LICENSE](LattesExtractor/LICENSE) para verificar os limites e direitos de distribuição e uso (GNU GPL v3).\r\n",
  "note": "Don't delete this file! It's used internally to help with page regeneration."
}